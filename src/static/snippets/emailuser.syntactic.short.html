<pre class="line-numbers"><code class="language-java"><span class="line"><span class="token comment" spellcheck="true">// User of an email software, saves individual settings and offers customisation of email</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmailUser</span> <span class="token punctuation">{</span></span>
<span class="line">	<span class="token keyword">private</span> Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> <span class="token operator">?</span><span class="token operator">></span> userSettings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span>Email email<span class="token punctuation">,</span> SendContext sendContext<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		Language systemLanguage <span class="token operator">=</span> <span class="token punctuation">(</span>Language<span class="token punctuation">)</span> Environment<span class="token punctuation">.</span><span class="token function">getLanguage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		Language userLanguage <span class="token operator">=</span> <span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token string">"language"</span><span class="token punctuation">,</span> systemLanguage<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		SpellChecker spellChecker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpellChecker</span><span class="token punctuation">(</span>userLanguage<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>spellChecker<span class="token punctuation">.</span><span class="token function">containsErrors</span><span class="token punctuation">(</span>email<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>UI<span class="token punctuation">.</span><span class="token function">ask</span><span class="token punctuation">(</span><span class="token string">"The email contains spelling mistakes. Do you still want to send it?"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">				sendContext<span class="token punctuation">.</span><span class="token function">abortSending</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">				<span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="line">			<span class="token punctuation">}</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">		</span>
<span class="line">		StyledText defaultSignature <span class="token operator">=</span> DefaultSettings<span class="token punctuation">.</span>SIGNATURE<span class="token punctuation">;</span></span>
<span class="line">		StyledText signature <span class="token operator">=</span> <span class="token punctuation">(</span>StyledText<span class="token punctuation">)</span> <span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token string">"signature"</span><span class="token punctuation">,</span> defaultSignature<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">		email<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>email<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>signature<span class="token punctuation">.</span><span class="token function">asHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">	<span class="token keyword">private</span> Object <span class="token function">getSetting</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> Object alternative<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>userSettings<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">			<span class="token keyword">return</span> userSettings<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">		<span class="token punctuation">}</span></span>
<span class="line">		<span class="token keyword">return</span> alternative<span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span>
</code></pre>