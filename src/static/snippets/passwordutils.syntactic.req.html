<pre class="line-numbers"><code class="language-java">
<span class="line"><span class="token comment" spellcheck="true">===Documentation===</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Constructs a cryptographically strong and secure random number generator (RNG) implementing the default random number</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * algorithm. The returned SecureRandom object has not been seeded. If {@code setSeed} is not called, the first call to</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * {@code nextBytes} will force the SecureRandom object to seed itself.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token function">SecureRandom</span><span class="token punctuation">() {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Generates a user-specified number of random bytes.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> bytes the array to be filled in with random bytes.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> void <span class="token function">nextBytes</span><span class="token punctuation">(</span>byte<span class="token punctuation">[]</span> bytes<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Reseeds this random object. The given seed supplements, rather than replaces, the existing seed.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> seed the seed.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">synchronized public</span> void <span class="token function">setSeed</span><span class="token punctuation">(</span>byte<span class="token punctuation">[]</span> seed<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Constructs the specification (of type KeySpec) for a user-chosen password that can be used with</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * password-based encryption (<i>PBE</i>). The password can be viewed as some kind of raw key material, from which the</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * encryption mechanism that uses it derives a cryptographic key.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * An empty char[] is used as password in this constructor. To define a custom password use the appropriate</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * setter.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token function">PBEKeySpec</span><span class="token punctuation">() {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Constructor that takes a salt, iteration count, and to-be-derived key length for generating PBEKey of</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * variable-key-size PBE ciphers. An empty char[] is used as password in this constructor. To define a</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * custom password use the appropriate setter.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> salt the salt.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> iterationCount the iteration count.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> keyLength the to-be-derived key length.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> NullPointerException if salt is null.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> IllegalArgumentException if salt is empty, i.e. 0-length, iterationCount or</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * keyLength is not positive.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token function">PBEKeySpec</span><span class="token punctuation">(</span>byte<span class="token punctuation">[]</span> salt<span class="token punctuation">,</span> int iterationCount<span class="token punctuation">,</span> int keyLength<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Constructor that takes a password, salt, iteration count, and to-be-derived key length for generating PBEKey of</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * variable-key-size PBE ciphers. Delivers a completely configured, ready to use PBEKeySpec.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> password the password. An empty char[] is used if null is specified for password.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> salt the salt.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> iterationCount the iteration count.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> keyLength the to-be-derived key length.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> NullPointerException if salt is null.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> IllegalArgumentException if salt is empty, i.e. 0-length, iterationCount or</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * keyLength is not positive.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token function">PBEKeySpec</span><span class="token punctuation">(</span>char<span class="token punctuation">[]</span> password<span class="token punctuation">,</span> byte<span class="token punctuation">[]</span> salt<span class="token punctuation">,</span> int iterationCount<span class="token punctuation">,</span> int keyLength<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Sets the password for the KeySpec. An empty char[] is used if null is specified for password.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> password the password.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> void <span class="token function">setPassword</span><span class="token punctuation">(</span>char<span class="token punctuation">[]</span> password<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Sets the salt for the KeySpec.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> salt the salt</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> NullPointerException if salt is null.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> IllegalArgumentException if salt is empty.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> void <span class="token function">setSalt</span><span class="token punctuation">(</span>byte<span class="token punctuation">[]</span> salt<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Sets the iterationCount for the KeySpec.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> iterationCount the iterationCount.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> IllegalArgumentException if iterationCount is not positive.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> void <span class="token function">setIterationCount</span><span class="token punctuation">(</span>int iterationCount<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Sets the keyLength for the KeySpec.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> keyLength the keyLength.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> IllegalArgumentException if keyLength is not positive.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public</span> void <span class="token function">setKeyLength</span><span class="token punctuation">(</span>int keyLength<span class="token punctuation">) {}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Clears the internal copy of the password.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public final</span> void <span class="token function">clearPassword</span><span class="token punctuation">() {}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Returns a SecretKeyFactory object that converts secret <I>keys</I> (opaque cryptographic keys of type</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Key) into <I>key specifications</I> (transparent representations of the underlying key material), and</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * vice versa, using the specified algorithm.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> algorithm the standard name of the requested secret-key algorithm (e.g. "PBKDF2WithHmacSHA1").</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@return</span> the new SecretKeyFactory object.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> NullPointerException if the specified algorithm is null.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> NoSuchAlgorithmException if no Provider supports a SecretKeyFactorySpi implementation for the specified</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * algorithm.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public static final</span> SecretKeyFactory <span class="token function">getInstance</span><span class="token punctuation">(</span>String algorithm<span class="token punctuation">)</span> <span class="token keyword">throws</span> NoSuchAlgorithmException <span class="token punctuation">{}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Generates a SecretKey object from the provided key specification (key material).</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> keySpec the specification (key material) of the secret key</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@return</span> the secret key</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> InvalidKeySpecException if the given key specification is inappropriate for this secret-key factory to</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * produce a secret key.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public final </span> SecretKey <span class="token function">generateSecret</span><span class="token punctuation">(</span>KeySpec keySpec<span class="token punctuation">)</span> <span class="token keyword">throws</span> InvalidKeySpecException <span class="token punctuation">{}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * Returns a specification (key material) of the given key object in the requested format.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> *</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> key the key</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@param</span> keySpec the requested format in which the key material shall be  returned</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@return</span> the underlying key specification (key material) in the requested format</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * <span class="token keyword">@exception</span> InvalidKeySpecException if the requested key specification is inappropriate for the given key.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line"><span class="token keyword">public final </span> KeySpec <span class="token function">getKeySpec</span><span class="token punctuation">(</span>SecretKey key<span class="token punctuation">,</span> Class<span class="token punctuation"><?></span> keySpec<span class="token punctuation">)</span> <span class="token keyword">throws</span> InvalidKeySpecException <span class="token punctuation">{}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">===End of Documentation===</span></span>
<span class="line"></span>
<span class="line"><span class="token comment" spellcheck="true">/**</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * This utility class contains methods to encrypt a given password (to be able to store it more securely) or to verify</span></span>
<span class="line"><span class="token comment" spellcheck="true"> * that the given password matches an encrypted version.</span></span>
<span class="line"><span class="token comment" spellcheck="true"> */</span></span>
<span class="line">public class <span class="token class-name">PasswordUtils</span> <span class="token punctuation">{</span></span>
<span class="line">   </span>
<span class="line">   <span class="token keyword">private final static</span> int ITERATIONS <span class="token operator">=</span> 200<span class="token punctuation">;</span></span>
<span class="line">   <span class="token keyword">private final static</span> int KEY_LENGTH <span class="token operator">=</span> 256<span class="token punctuation">;</span></span>
<span class="line">   <span class="token keyword">private final static</span> int SALT_LENGTH <span class="token operator">=</span> 30<span class="token punctuation">;</span></span>
<span class="line">   </span>
<span class="line">   <span class="token keyword">public static</span> void <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">       <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">==</span> 2 <span class="token operator">&&</span> args<span class="token punctuation">[</span>0<span class="token punctuation">].</span><span class="token function">equals</span><span class="token punctuation">("</span>encrypt<span class="token punctuation">")) {</span></span>
<span class="line">           <span class="token comment" spellcheck="true">// Generate Salt. The generated value can be stored in DB.</span></span>
<span class="line">           String salt <span class="token operator">=</span> PasswordUtils<span class="token punctuation">.</span><span class="token function">generateSalt</span><span class="token punctuation">(</span>SALT_LENGTH<span class="token punctuation">);</span></span>
<span class="line">           </span>
<span class="line">           <span class="token comment" spellcheck="true">// Protect user's password. The generated value can be stored in DB.</span></span>
<span class="line">           String encryptedPassword <span class="token operator">=</span> PasswordUtils<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>1<span class="token punctuation">],</span> salt<span class="token punctuation">);</span></span>
<span class="line">           </span>
<span class="line">           System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">("</span>Secured password = <span class="token punctuation">"</span> <span class="token operator">+</span> encryptedPassword<span class="token punctuation">);</span></span>
<span class="line">           System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">("</span>Salt value = <span class="token punctuation">"</span> <span class="token operator">+</span> salt<span class="token punctuation">);</span></span>
<span class="line">           </span>
<span class="line">       <span class="token punctuation">}</span> <span class="token keyword">else if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">==</span> 4 <span class="token operator">&&</span> args<span class="token punctuation">[</span>0<span class="token punctuation">].</span><span class="token function">equals</span><span class="token punctuation">("</span>verify<span class="token punctuation">")) {</span></span>
<span class="line">           <span class="token comment" spellcheck="true">// Generate new secure password with the same salt and compare.</span></span>
<span class="line">           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">verify</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>1<span class="token punctuation">],</span> args<span class="token punctuation">[</span>2<span class="token punctuation">],</span> args<span class="token punctuation">[</span>3<span class="token punctuation">])) {</span></span>
<span class="line">               System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">("</span>Provided password is correct.<span class="token punctuation">");</span></span>
<span class="line">               </span>
<span class="line">           <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">               System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">("</span>Provided password is incorrect.<span class="token punctuation">");</span></span>
<span class="line">           <span class="token punctuation">}</span></span>
<span class="line">       </span>
<span class="line">       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">           System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">("</span>Error > Input must be either: <span class="token operator">\n</span> encrypt [password] <span class="token operator">\n</span> - or - <span class="token operator">\n</span> verify [password] <span class="token punctuation">"</span> <span class="token operator">+</span></span>
<span class="line">                   <span class="token punctuation">"</span>[encrypted password] [salt]<span class="token punctuation">");</span></span>
<span class="line">       <span class="token punctuation">}</span></span>
<span class="line">   <span class="token punctuation">}</span></span>
<span class="line">   </span>
<span class="line">   <span class="token keyword">public static</span> String <span class="token function">generateSalt</span><span class="token punctuation">(</span><span class="token keyword">final</span> int length<span class="token punctuation">) {</span></span>
<span class="line">       byte<span class="token punctuation">[]</span> salt <span class="token operator">=</span> <span class="token keyword">new</span> byte<span class="token punctuation">[</span>length<span class="token punctuation">];</span></span>
<span class="line">       <span class="token keyword">new</span> <span class="token function">SecureRandom</span><span class="token punctuation">().</span><span class="token function">nextBytes</span><span class="token punctuation">(</span>salt<span class="token punctuation">);</span></span>
<span class="line">   </span>
<span class="line">       <span class="token comment" spellcheck="true">// Return printable form.</span></span>
<span class="line">       <span class="token keyword">return</span> Base64<span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">().</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>salt<span class="token punctuation">);</span></span>
<span class="line">   <span class="token punctuation">}</span></span>
<span class="line">   </span>
<span class="line">   <span class="token keyword">public static</span> String <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">final</span> String password<span class="token punctuation">,</span> <span class="token keyword">final</span> String salt<span class="token punctuation">) {</span></span>
<span class="line">       byte<span class="token punctuation">[]</span> encryptedPassword <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(),</span> salt<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">());</span></span>
<span class="line">       </span>
<span class="line">       <span class="token keyword">return</span> Base64<span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">().</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encryptedPassword<span class="token punctuation">);</span></span>
<span class="line">   <span class="token punctuation">}</span></span>
<span class="line">   </span>
<span class="line">   <span class="token keyword">public static</span> byte<span class="token punctuation">[]</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token keyword">final</span> char<span class="token punctuation">[]</span> password<span class="token punctuation">,</span> <span class="token keyword">final</span> byte<span class="token punctuation">[]</span> salt<span class="token punctuation">) {</span></span>
<span class="line">       PBEKeySpec spec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">PBEKeySpec</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> ITERATIONS<span class="token punctuation">,</span> KEYLENGTH<span class="token punctuation">);</span></span>
<span class="line">       <span class="token comment" spellcheck="true">// Erase the password.</span></span>
<span class="line">       Arrays<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> Character<span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">);</span></span>
<span class="line">       </span>
<span class="line">       <span class="token keyword"></span>try <span class="token punctuation">{</span></span>
<span class="line">           SecretKeyFactory keys <span class="token operator">=</span> SecretKeyFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">("</span>PBKDF2WithHmacSHA1<span class="token punctuation">");</span></span>
<span class="line">           <span class="token keyword">return</span> keys<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>spec<span class="token punctuation">).</span><span class="token function">getEncoded</span><span class="token punctuation">();</span></span>
<span class="line">           </span>
<span class="line">       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>NoSuchAlgorithmException <span class="token operator">|</span> InvalidKeySpecException e<span class="token punctuation">) {</span></span>
<span class="line">           <span class="token keyword">throw new</span> <span class="token function">AssertionError</span><span class="token punctuation">("</span>Error > Password could not be hashed: <span class="token punctuation">"</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(),</span> e<span class="token punctuation">);</span></span>
<span class="line">           </span>
<span class="line">       <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></span>
<span class="line">           spec<span class="token punctuation">.</span><span class="token function">clearPassword</span><span class="token punctuation">();</span></span>
<span class="line">       <span class="token punctuation">}</span></span>
<span class="line">   <span class="token punctuation">}</span></span>
<span class="line">   </span>
<span class="line">   <span class="token keyword">public static</span> boolean <span class="token function">verify</span><span class="token punctuation">(</span><span class="token keyword">final</span> String password<span class="token punctuation">,</span> <span class="token keyword">final</span> String encryptedPassword<span class="token punctuation">,</span> <span class="token keyword">final</span> String salt<span class="token punctuation">) {</span></span>
<span class="line">       String newEncryptedPassword <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">);</span></span>
<span class="line">       <span class="token keyword">return</span> newEncryptedPassword<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>encryptedPassword<span class="token punctuation">);</span></span>
<span class="line">   <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
</code></pre>
